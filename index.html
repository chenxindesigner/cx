<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Flex ä¸€éµåˆ†äº«å¡ç‰‡å·¥å…·</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
</head>
<body>
  <h2>Flex JSON è¼¸å…¥å€</h2>
  <textarea id="flexJsonInput" style="width:90%; height:400px;">
{
  "type": "bubble",
  "hero": {
    "type": "image",
    "url": "https://developers-resource.landpress.line.me/fx/img/01_1_cafe.png",
    "size": "full",
    "aspectRatio": "20:13",
    "aspectMode": "cover",
    "action": {
      "type": "uri",
      "uri": "https://line.me/"
    }
  },
  "body": {
    "type": "box",
    "layout": "vertical",
    "contents": [
      {
        "type": "text",
        "text": "Brown Cafe",
        "weight": "bold",
        "size": "xl"
      },
      {
        "type": "box",
        "layout": "baseline",
        "margin": "md",
        "contents": [
          {
            "type": "icon",
            "size": "sm",
            "url": "https://developers-resource.landpress.line.me/fx/img/review_gold_star_28.png"
          },
          {
            "type": "icon",
            "size": "sm",
            "url": "https://developers-resource.landpress.line.me/fx/img/review_gold_star_28.png"
          },
          {
            "type": "icon",
            "size": "sm",
            "url": "https://developers-resource.landpress.line.me/fx/img/review_gold_star_28.png"
          },
          {
            "type": "icon",
            "size": "sm",
            "url": "https://developers-resource.landpress.line.me/fx/img/review_gold_star_28.png"
          },
          {
            "type": "icon",
            "size": "sm",
            "url": "https://developers-resource.landpress.line.me/fx/img/review_gray_star_28.png"
          },
          {
            "type": "text",
            "text": "4.0",
            "size": "sm",
            "color": "#999999",
            "margin": "md",
            "flex": 0
          }
        ]
      },
      {
        "type": "box",
        "layout": "vertical",
        "margin": "lg",
        "spacing": "sm",
        "contents": [
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "Place",
                "color": "#aaaaaa",
                "size": "sm",
                "flex": 1
              },
              {
                "type": "text",
                "text": "Flex Tower, 7-7-4 Midori-ku, Tokyo",
                "wrap": true,
                "color": "#666666",
                "size": "sm",
                "flex": 5
              }
            ]
          },
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "Time",
                "color": "#aaaaaa",
                "size": "sm",
                "flex": 1
              },
              {
                "type": "text",
                "text": "10:00 - 23:00",
                "wrap": true,
                "color": "#666666",
                "size": "sm",
                "flex": 5
              }
            ]
          }
        ]
      }
    ]
  },
  "footer": {
    "type": "box",
    "layout": "vertical",
    "spacing": "sm",
    "contents": [
      {
        "type": "button",
        "style": "link",
        "height": "sm",
        "action": {
          "type": "uri",
          "label": "CALL",
          "uri": "https://line.me/"
        }
      },
      {
        "type": "button",
        "style": "link",
        "height": "sm",
        "action": {
          "type": "uri",
          "label": "WEBSITE",
          "uri": "https://line.me/"
        }
      },
      {
        "type": "box",
        "layout": "vertical",
        "contents": [],
        "margin": "sm"
      }
    ],
    "flex": 0
  }
}
  </textarea>
  <br><br>
  <button onclick="shareFlexMessage()">ğŸ“¤ åˆ†äº«çµ¦å¥½å‹</button>

  <script>
    liff.init({ liffId: '2007730669-BZpPW38q' })
      .then(() => {
        if (!liff.isLoggedIn()) {
          liff.login();
        }
      })
      .catch((err) => {
        console.error('LIFF åˆå§‹åŒ–å¤±æ•—:', err);
        alert('LIFF åˆå§‹åŒ–å¤±æ•—ï¼Œè«‹ç¢ºèª LIFF ID æ˜¯å¦æ­£ç¢º');
      });

    async function shareFlexMessage() {
      const jsonText = document.getElementById("flexJsonInput").value;
      let json;
      try {
        json = JSON.parse(jsonText);
      } catch (e) {
        alert("âŒ JSON æ ¼å¼éŒ¯èª¤ï¼Œè«‹ç¢ºèªå…§å®¹");
        return;
      }

      if (!liff.isApiAvailable('shareTargetPicker')) {
        alert("ç›®å‰è£ç½®ä¸æ”¯æ´åˆ†äº«åŠŸèƒ½");
        return;
      }

      try {
        await liff.shareTargetPicker([
          {
            type: "flex",
            altText: json.body?.contents?.[0]?.text || "é€™æ˜¯ä¸€å‰‡ Flex è¨Šæ¯",
            contents: json
          }
        ]);
      } catch (e) {
        console.error("âŒ åˆ†äº«å¤±æ•—ï¼š", e);
        alert("Flex åˆ†äº«å¤±æ•—ï¼Œè«‹å†æ¬¡ç¢ºèªæ ¼å¼");
      }
    }
  </script>
</body>
</html>
